{"version":3,"file":"taquito-tezbridge-signer.umd.js","sources":["../src/taquito-tezbridge-signer.ts"],"sourcesContent":["import { b58cdecode, b58cencode, buf2hex, prefix } from '@taquito/utils';\nimport toBuffer from 'typedarray-to-buffer';\n\ndeclare var tezbridge: any;\n\nexport class TezBridgeSigner {\n  constructor() {\n    if (typeof tezbridge === 'undefined') {\n      throw new Error('tezbridge plugin could not be detected in your browser');\n    }\n  }\n\n  async publicKeyHash(): Promise<string> {\n    return tezbridge.request({ method: 'get_source' });\n  }\n\n  async publicKey(): Promise<string> {\n    throw new Error('Public key cannot be exposed');\n  }\n\n  async secretKey(): Promise<string> {\n    throw new Error('Secret key cannot be exposed');\n  }\n\n  async sign(bytes: string, _watermark?: Uint8Array) {\n    const prefixSig = await tezbridge.request({\n      method: 'raw_sign',\n      bytes, // Any operation bytes as string\n    });\n\n    const decoded = b58cdecode(prefixSig, prefix[prefixSig.substr(0, 5)]);\n\n    return {\n      bytes,\n      sig: b58cencode(decoded, prefix.sig),\n      prefixSig,\n      sbytes: bytes + buf2hex(toBuffer(decoded)),\n    };\n  }\n}\n"],"names":["b58cdecode","prefix","b58cencode","buf2hex"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAME;YACE,IAAI,OAAO,SAAS,KAAK,WAAW,EAAE;gBACpC,MAAM,IAAI,KAAK,CAAC,wDAAwD,CAAC,CAAC;aAC3E;SACF;QAEK,uCAAa,GAAnB;;;oBACE,sBAAO,SAAS,CAAC,OAAO,CAAC,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,EAAC;;;SACpD;QAEK,mCAAS,GAAf;;;oBACE,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;;;SACjD;QAEK,mCAAS,GAAf;;;oBACE,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;;;SACjD;QAEK,8BAAI,GAAV,UAAW,KAAa,EAAE,UAAuB;;;;;gCAC7B,qBAAM,SAAS,CAAC,OAAO,CAAC;gCACxC,MAAM,EAAE,UAAU;gCAClB,KAAK,OAAA;6BACN,CAAC,EAAA;;4BAHI,SAAS,GAAG,SAGhB;4BAEI,OAAO,GAAGA,gBAAU,CAAC,SAAS,EAAEC,YAAM,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;4BAEtE,sBAAO;oCACL,KAAK,OAAA;oCACL,GAAG,EAAEC,gBAAU,CAAC,OAAO,EAAED,YAAM,CAAC,GAAG,CAAC;oCACpC,SAAS,WAAA;oCACT,MAAM,EAAE,KAAK,GAAGE,aAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;iCAC3C,EAAC;;;;SACH;QACH,sBAAC;IAAD,CAAC;;;;;;;;;;;;"}