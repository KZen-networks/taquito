import { Expr } from '../src/micheline';
import { Parser } from '../src/micheline-parser';
import { emitMicheline } from '../src/micheline-emitter';
import { assertMichelsonScript, assertMichelsonData } from '../src/michelson-validator';

interface APIData {
  code: Expr;
  storage: Expr;
}

const testData: {
  json: string;
  code: string;
  storage: string;
  src?: APIData;
}[] = [
  {
    json:
      '{"code":[{"prim":"parameter","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat","annots":[":proposalId"]},{"prim":"pair","args":[{"prim":"key","annots":[":votePk"]},{"prim":"signature","annots":[":voteSig"]}]}],"annots":["%voteForProposal"]},{"prim":"pair","args":[{"prim":"address","annots":[":owner"]},{"prim":"contract","args":[{"prim":"nat"}]}],"annots":["%getBalance"]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}],"annots":["%getTotalSupply"]},{"prim":"bytes","annots":["%fund"]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"set","args":[{"prim":"key_hash"}],"annots":["%newCouncil"]},{"prim":"pair","args":[{"prim":"address","annots":[":from"]},{"prim":"pair","args":[{"prim":"address","annots":[":to"]},{"prim":"nat","annots":[":value"]}]}],"annots":["%transfer"]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"string","annots":[":description"]},{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}],"annots":[":newPolicy"]}],"annots":["%newProposal"]},{"prim":"unit","annots":["%freeze"]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address","annots":[":to"]},{"prim":"mutez","annots":[":amount"]}],"annots":["%withdraw"]},{"prim":"lambda","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat","annots":[":proposalId"]},{"prim":"pair","args":[{"prim":"key","annots":[":votePk"]},{"prim":"signature","annots":[":voteSig"]}]}]},{"prim":"pair","args":[{"prim":"address","annots":[":owner"]},{"prim":"contract","args":[{"prim":"nat"}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}]},{"prim":"bytes"}]}]},{"prim":"operation"}],"annots":[":successor","%setSuccessor"]}]}]}]}]},{"prim":"storage","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"set","args":[{"prim":"key_hash"}]}]},{"prim":"pair","args":[{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"bytes"}]}]},{"prim":"map","args":[{"prim":"key_hash"},{"prim":"nat"}]}]}]}]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"nat"}]},{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"address"},{"prim":"nat"}]},{"prim":"pair","args":[{"prim":"bool"},{"prim":"option","args":[{"prim":"lambda","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"pair","args":[{"prim":"key"},{"prim":"signature"}]}]},{"prim":"pair","args":[{"prim":"address"},{"prim":"contract","args":[{"prim":"nat"}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}]},{"prim":"bytes"}]}]},{"prim":"operation"}]}]}]}]}]}]}]},{"prim":"code","args":[[{"prim":"CAST","args":[{"prim":"pair","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"pair","args":[{"prim":"key"},{"prim":"signature"}]}]},{"prim":"pair","args":[{"prim":"address"},{"prim":"contract","args":[{"prim":"nat"}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}]},{"prim":"bytes"}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"set","args":[{"prim":"key_hash"}]},{"prim":"pair","args":[{"prim":"address"},{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"unit"}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"mutez"}]},{"prim":"lambda","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"pair","args":[{"prim":"key"},{"prim":"signature"}]}]},{"prim":"pair","args":[{"prim":"address"},{"prim":"contract","args":[{"prim":"nat"}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}]},{"prim":"bytes"}]}]},{"prim":"operation"}]}]}]}]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"set","args":[{"prim":"key_hash"}]}]},{"prim":"pair","args":[{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"bytes"}]}]},{"prim":"map","args":[{"prim":"key_hash"},{"prim":"nat"}]}]}]}]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"nat"}]},{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"address"},{"prim":"nat"}]},{"prim":"pair","args":[{"prim":"bool"},{"prim":"option","args":[{"prim":"lambda","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"pair","args":[{"prim":"key"},{"prim":"signature"}]}]},{"prim":"pair","args":[{"prim":"address"},{"prim":"contract","args":[{"prim":"nat"}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}]},{"prim":"bytes"}]}]},{"prim":"operation"}]}]}]}]}]}]}]}]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"IF_LEFT","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF_NONE","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"unit"},{"prim":"Unit"}]},{"prim":"PUSH","args":[{"prim":"string"},{"string":"ContractFrozen"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"NOW"},{"prim":"PUSH","args":[{"prim":"timestamp"},{"string":"1858-11-17T00:00:00Z"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"86400"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: extractDate: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"678575"}]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"146097"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"36524"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (2)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[],[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"36524"}]},{"prim":"MUL"},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1461"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (3)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"365"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (4)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[],[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"365"}]},{"prim":"MUL"}]]},{"prim":"SUB"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (5)"}]},{"prim":"FAILWITH"}],[]]}]]},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"400"}]},{"prim":"MUL"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"DIP","args":[[]]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"MUL"}]]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"100"}]},{"prim":"MUL"}]]},{"prim":"ADD"}]]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"400"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: isLeap: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"INT"},{"prim":"EQ"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"100"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: isLeap: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"INT"},{"prim":"NEQ"},{"prim":"OR"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: isLeap: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"INT"},{"prim":"EQ"},{"prim":"AND"},{"prim":"PUSH","args":[{"prim":"list","args":[{"prim":"nat"}]},[{"int":"31"},{"int":"30"},{"int":"31"},{"int":"30"},{"int":"31"},{"int":"31"},{"int":"30"},{"int":"31"},{"int":"30"},{"int":"31"}]]},{"prim":"SWAP"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"29"}]}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"28"}]}]]},{"prim":"CONS"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"31"}]},{"prim":"CONS"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: yearDayToMonthAndDay: year day <= 1"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SOME"},{"prim":"DIP","args":[[{"prim":"NONE","args":[{"prim":"nat"}]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}]]}]]},{"prim":"ITER","args":[[{"prim":"SWAP"},{"prim":"IF_NONE","args":[[{"prim":"DROP"},{"prim":"NONE","args":[{"prim":"nat"}]}],[{"prim":"DIP","args":[{"int":"2"},[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"SOME"}]]},{"prim":"NONE","args":[{"prim":"nat"}]}],[{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"SOME"}]]}]]}]]},{"prim":"DROP"},{"prim":"DIP","args":[[{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: yearDayToMonthAndDay: year day is greater than number of days in year"}]},{"prim":"FAILWITH"}],[]]}]]}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2020"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: getCurrentStage: start year in future"}]},{"prim":"FAILWITH"}],[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"48"}]},{"prim":"MUL"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"-1"}]},{"prim":"ADD"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: getCurrentStage: month = 0"}]},{"prim":"FAILWITH"}],[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"MUL"}]]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"8"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"15"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"22"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2"}]}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]}]]}]]}]]}]]},{"prim":"ADD"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"COMPARE"},{"prim":"DUP"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"DROP"},{"prim":"DROP"}],[{"prim":"LT"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"WrongStage"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"DUP"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"EMPTY_MAP","args":[{"prim":"nat"},{"prim":"nat"}]},{"prim":"SWAP"},{"prim":"ITER","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"CDR"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"option","args":[{"prim":"nat"}]},{"prim":"Some","args":[{"int":"1"}]}]}]]},{"prim":"UPDATE"}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"SOME"},{"prim":"SWAP"},{"prim":"UPDATE"}]]}]]},{"prim":"NONE","args":[{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"SWAP"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"SIZE"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"SWAP"},{"prim":"ITER","args":[[{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]}]]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2"}]},{"prim":"MUL"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"COMPARE"},{"prim":"GT"}]]}]]},{"prim":"DIG","args":[{"int":"4"}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"IF","args":[[{"prim":"IF_NONE","args":[[{"prim":"CDR"},{"prim":"SOME"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: \\"calcWinner: more than one winner\\""}]},{"prim":"FAILWITH"}]]}],[{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"}]]},{"prim":"DROP"},{"prim":"DROP"},{"prim":"DROP"},{"prim":"IF_NONE","args":[[],[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"}]]},{"prim":"NIL","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"bytes"}]}]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"EMPTY_MAP","args":[{"prim":"key_hash"},{"prim":"nat"}]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"}]]}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"}]]}]]}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2"}]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"WrongStage"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}]]},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"HASH_KEY"},{"prim":"DIP","args":[[{"prim":"DIG","args":[{"int":"2"}]}]]},{"prim":"DUP"},{"prim":"DIP","args":[{"int":"2"},[{"prim":"DUP"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"}]]},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"MEM"},{"prim":"IF","args":[[{"prim":"DIP","args":[[{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"}]]},{"prim":"GET"},{"prim":"IF_NONE","args":[[],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"VoteAlreadySubmitted"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"NotInCouncil"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"},{"prim":"CDR"},{"prim":"SWAP"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DIP","args":[[{"prim":"INT"},{"prim":"NONE","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"bytes"}]}]}]]},{"prim":"ITER","args":[[{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DIP","args":[{"int":"2"},[{"prim":"DROP"}]]},{"prim":"DIP","args":[[{"prim":"SOME"}]]}],[{"prim":"SWAP"},{"prim":"DROP"}]]},{"prim":"PUSH","args":[{"prim":"int"},{"int":"1"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"SWAP"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"InvalidProposalId"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[{"prim":"CDR"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SELF"},{"prim":"ADDRESS"},{"prim":"DIP","args":[[{"prim":"DIP","args":[{"int":"4"},[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CAR"}]]},{"prim":"DIG","args":[{"int":"4"}]}]]},{"prim":"PAIR"}]]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PACK"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DIG","args":[{"int":"2"}]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CHECK_SIGNATURE"}]]},{"prim":"SWAP"},{"prim":"IF","args":[[{"prim":"DROP"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"InvalidSignature"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}]]},{"prim":"HASH_KEY"},{"prim":"DIP","args":[[{"prim":"SOME"}]]},{"prim":"DIP","args":[{"int":"2"},[{"prim":"DUP"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"}]]},{"prim":"UPDATE"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"}]]},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}],[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"}]]},{"prim":"PAIR"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"}]]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[]]},{"prim":"DIP","args":[[{"prim":"AMOUNT"}]]},{"prim":"TRANSFER_TOKENS"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"SWAP"},{"prim":"CONS"},{"prim":"PAIR"}]]}],[{"prim":"IF_LEFT","args":[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"}]]},{"prim":"PAIR"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DROP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIP","args":[[{"prim":"AMOUNT"}]]},{"prim":"TRANSFER_TOKENS"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"SWAP"},{"prim":"CONS"},{"prim":"PAIR"}],[{"prim":"DROP"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}]]}]]}],[{"prim":"SWAP"},{"prim":"EXEC"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"SWAP"},{"prim":"CONS"},{"prim":"PAIR"}]]}],[{"prim":"IF_LEFT","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"unit"},{"prim":"Unit"}]},{"prim":"PUSH","args":[{"prim":"string"},{"string":"ContractFrozen"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"SENDER"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"SenderCheckFailed"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}]]},{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"NOW"},{"prim":"PUSH","args":[{"prim":"timestamp"},{"string":"1858-11-17T00:00:00Z"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"86400"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: extractDate: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"678575"}]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"146097"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"36524"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (2)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[],[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"36524"}]},{"prim":"MUL"},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1461"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (3)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"365"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (4)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[],[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"365"}]},{"prim":"MUL"}]]},{"prim":"SUB"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (5)"}]},{"prim":"FAILWITH"}],[]]}]]},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"400"}]},{"prim":"MUL"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"DIP","args":[[]]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"MUL"}]]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"100"}]},{"prim":"MUL"}]]},{"prim":"ADD"}]]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"400"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: isLeap: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"INT"},{"prim":"EQ"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"100"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: isLeap: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"INT"},{"prim":"NEQ"},{"prim":"OR"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: isLeap: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"INT"},{"prim":"EQ"},{"prim":"AND"},{"prim":"PUSH","args":[{"prim":"list","args":[{"prim":"nat"}]},[{"int":"31"},{"int":"30"},{"int":"31"},{"int":"30"},{"int":"31"},{"int":"31"},{"int":"30"},{"int":"31"},{"int":"30"},{"int":"31"}]]},{"prim":"SWAP"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"29"}]}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"28"}]}]]},{"prim":"CONS"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"31"}]},{"prim":"CONS"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: yearDayToMonthAndDay: year day <= 1"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SOME"},{"prim":"DIP","args":[[{"prim":"NONE","args":[{"prim":"nat"}]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}]]}]]},{"prim":"ITER","args":[[{"prim":"SWAP"},{"prim":"IF_NONE","args":[[{"prim":"DROP"},{"prim":"NONE","args":[{"prim":"nat"}]}],[{"prim":"DIP","args":[{"int":"2"},[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"SOME"}]]},{"prim":"NONE","args":[{"prim":"nat"}]}],[{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"SOME"}]]}]]}]]},{"prim":"DROP"},{"prim":"DIP","args":[[{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: yearDayToMonthAndDay: year day is greater than number of days in year"}]},{"prim":"FAILWITH"}],[]]}]]}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2020"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: getCurrentStage: start year in future"}]},{"prim":"FAILWITH"}],[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"48"}]},{"prim":"MUL"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"-1"}]},{"prim":"ADD"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: getCurrentStage: month = 0"}]},{"prim":"FAILWITH"}],[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"MUL"}]]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"8"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"15"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"22"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2"}]}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]}]]}]]}]]}]]},{"prim":"ADD"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"COMPARE"},{"prim":"DUP"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"DROP"},{"prim":"DROP"}],[{"prim":"LT"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"WrongStage"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"DUP"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"EMPTY_MAP","args":[{"prim":"nat"},{"prim":"nat"}]},{"prim":"SWAP"},{"prim":"ITER","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"CDR"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"option","args":[{"prim":"nat"}]},{"prim":"Some","args":[{"int":"1"}]}]}]]},{"prim":"UPDATE"}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"SOME"},{"prim":"SWAP"},{"prim":"UPDATE"}]]}]]},{"prim":"NONE","args":[{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"SWAP"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"SIZE"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"SWAP"},{"prim":"ITER","args":[[{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]}]]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2"}]},{"prim":"MUL"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"COMPARE"},{"prim":"GT"}]]}]]},{"prim":"DIG","args":[{"int":"4"}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"IF","args":[[{"prim":"IF_NONE","args":[[{"prim":"CDR"},{"prim":"SOME"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: \\"calcWinner: more than one winner\\""}]},{"prim":"FAILWITH"}]]}],[{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"}]]},{"prim":"DROP"},{"prim":"DROP"},{"prim":"DROP"},{"prim":"IF_NONE","args":[[],[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"}]]},{"prim":"NIL","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"bytes"}]}]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"EMPTY_MAP","args":[{"prim":"key_hash"},{"prim":"nat"}]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"}]]}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"}]]}]]},{"prim":"DUP"},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]},{"prim":"COMPARE"},{"prim":"NEQ"},{"prim":"IF","args":[[{"prim":"DROP"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"WrongStage"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2"}]},{"prim":"COMPARE"},{"prim":"NEQ"},{"prim":"IF","args":[[{"prim":"DROP"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"WrongStage"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"DROP"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}],[{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"SWAP"},{"prim":"CAR"},{"prim":"DIP","args":[{"int":"2"},[{"prim":"DUP"}]]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"DIP","args":[{"int":"2"},[{"prim":"DUP"}]]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Address to be debited is not in ledger"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"DUP"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"NotEnoughFunds"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[{"prim":"SWAP"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"NONE","args":[{"prim":"nat"}]}],[{"prim":"SOME"}]]}]]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"UPDATE"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"SWAP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"DIP","args":[{"int":"2"},[{"prim":"DUP"}]]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"DIP","args":[{"int":"2"},[{"prim":"DUP"}]]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[]]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"ADD"},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"UPDATE"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}]]}],[{"prim":"IF_LEFT","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"NOW"},{"prim":"PUSH","args":[{"prim":"timestamp"},{"string":"1858-11-17T00:00:00Z"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"86400"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: extractDate: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"678575"}]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"146097"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"36524"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (2)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[],[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"36524"}]},{"prim":"MUL"},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1461"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (3)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"365"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (4)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[],[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"365"}]},{"prim":"MUL"}]]},{"prim":"SUB"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: toOrdinalDate: unexpected (5)"}]},{"prim":"FAILWITH"}],[]]}]]},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"400"}]},{"prim":"MUL"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"DIP","args":[[]]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"MUL"}]]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"100"}]},{"prim":"MUL"}]]},{"prim":"ADD"}]]},{"prim":"SWAP"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"400"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: isLeap: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"INT"},{"prim":"EQ"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"100"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: isLeap: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"INT"},{"prim":"NEQ"},{"prim":"OR"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]}]]},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: isLeap: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"CDR"},{"prim":"INT"},{"prim":"EQ"},{"prim":"AND"},{"prim":"PUSH","args":[{"prim":"list","args":[{"prim":"nat"}]},[{"int":"31"},{"int":"30"},{"int":"31"},{"int":"30"},{"int":"31"},{"int":"31"},{"int":"30"},{"int":"31"},{"int":"30"},{"int":"31"}]]},{"prim":"SWAP"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"29"}]}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"28"}]}]]},{"prim":"CONS"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"31"}]},{"prim":"CONS"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: yearDayToMonthAndDay: year day <= 1"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SOME"},{"prim":"DIP","args":[[{"prim":"NONE","args":[{"prim":"nat"}]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}]]}]]},{"prim":"ITER","args":[[{"prim":"SWAP"},{"prim":"IF_NONE","args":[[{"prim":"DROP"},{"prim":"NONE","args":[{"prim":"nat"}]}],[{"prim":"DIP","args":[{"int":"2"},[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"SOME"}]]},{"prim":"NONE","args":[{"prim":"nat"}]}],[{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"SOME"}]]}]]}]]},{"prim":"DROP"},{"prim":"DIP","args":[[{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: yearDayToMonthAndDay: year day is greater than number of days in year"}]},{"prim":"FAILWITH"}],[]]}]]}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2020"}]},{"prim":"SWAP"},{"prim":"SUB"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: getCurrentStage: start year in future"}]},{"prim":"FAILWITH"}],[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"48"}]},{"prim":"MUL"},{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"int"},{"int":"-1"}]},{"prim":"ADD"},{"prim":"ISNAT"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: getCurrentStage: month = 0"}]},{"prim":"FAILWITH"}],[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"MUL"}]]},{"prim":"ADD"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"8"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"15"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"22"}]},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2"}]}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"3"}]}]]}]]}]]}]]},{"prim":"ADD"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"COMPARE"},{"prim":"DUP"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"DROP"},{"prim":"DROP"}],[{"prim":"LT"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"WrongStage"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"DUP"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"EMPTY_MAP","args":[{"prim":"nat"},{"prim":"nat"}]},{"prim":"SWAP"},{"prim":"ITER","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"CDR"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"DIP","args":[[{"prim":"PUSH","args":[{"prim":"option","args":[{"prim":"nat"}]},{"prim":"Some","args":[{"int":"1"}]}]}]]},{"prim":"UPDATE"}],[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"},{"prim":"SOME"},{"prim":"SWAP"},{"prim":"UPDATE"}]]}]]},{"prim":"NONE","args":[{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"SWAP"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"SIZE"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"SWAP"},{"prim":"ITER","args":[[{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]}]]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]}],[]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"2"}]},{"prim":"MUL"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"COMPARE"},{"prim":"GT"}]]}]]},{"prim":"DIG","args":[{"int":"4"}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"IF","args":[[{"prim":"IF_NONE","args":[[{"prim":"CDR"},{"prim":"SOME"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: \\"calcWinner: more than one winner\\""}]},{"prim":"FAILWITH"}]]}],[{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"DIP","args":[[{"prim":"SWAP"}]]},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"1"}]},{"prim":"ADD"}]]},{"prim":"DROP"},{"prim":"DROP"},{"prim":"DROP"},{"prim":"IF_NONE","args":[[],[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"}]]},{"prim":"NIL","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"map","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"bytes"},{"prim":"string"}]}]}]},{"prim":"bytes"}]}]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"EMPTY_MAP","args":[{"prim":"key_hash"},{"prim":"nat"}]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"}]]}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"}]]}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"4"}]},{"prim":"SWAP"},{"prim":"EDIV"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"Internal: splitCounter: unexpected (1)"}]},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[]]},{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"nat"},{"int":"0"}]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"WrongStage"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}]]},{"prim":"DUP"},{"prim":"PACK"},{"prim":"BLAKE2B"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"}]]},{"prim":"CONS"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}],[{"prim":"DROP"},{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"True"}]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}]]}]]}],[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"SENDER"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"}],[{"prim":"PUSH","args":[{"prim":"string"},{"string":"SenderCheckFailed"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}]]},{"prim":"IF_LEFT","args":[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DUP"},{"prim":"CONTRACT","args":[{"prim":"unit"}]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"InvalidReceiver"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"SWAP"},{"prim":"CDR"},{"prim":"UNIT"},{"prim":"TRANSFER_TOKENS"},{"prim":"DIP","args":[[{"prim":"NIL","args":[{"prim":"operation"}]}]]},{"prim":"CONS"},{"prim":"PAIR"}],[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"IF","args":[[],[{"prim":"PUSH","args":[{"prim":"unit"},{"prim":"Unit"}]},{"prim":"PUSH","args":[{"prim":"string"},{"string":"ContractActive"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"SOME"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}]]}]]}]]}]]}],"storage":{"prim":"Pair","args":[{"prim":"Pair","args":[{"prim":"Pair","args":[{"bytes":"0158963b4895bb34f5f04323955088252919d49e1700"},[{"bytes":"003faad22c22aeb4d0b2c92930bc5c0d5d5cf3b685"},{"bytes":"00478ab1562c55ccfc169f66090d5627c8a4cc39bc"},{"bytes":"005f2931ed67ef176421fe74b3a58199bad671072e"},{"bytes":"0098c82adedb98b85ac32f8d5da333171c03bb924a"},{"bytes":"00c578052f1748383d913d82d84b0f0df50a56c0a0"}]]},{"prim":"Pair","args":[[{"prim":"Elt","args":[{"string":"url1"},{"prim":"Pair","args":[{"bytes":"d568d9a5924b70b34527529fd17a5d71e7d697b81777da1b2764e2a6636234cd"},{"string":"https://forum.stakerdao.com/uploads/short-url/bGNRrVlE3ir9sk7AB4el6Z5FmWT.pdf"}]}]}],{"prim":"Pair","args":[[{"prim":"Pair","args":[{"prim":"Pair","args":[{"string":"Proposal 005 - Blend on Tezos"},[{"prim":"Elt","args":[{"string":"url1"},{"prim":"Pair","args":[{"bytes":"305f752e2881c7088634478e1662ce2f1b037148d2128e71a20bcc6739385b91"},{"string":"https://forum.stakerdao.com/uploads/short-url/6NXzxt6SI8wv4KCpXiIUwvLE923.pdf"}]}]}]]},{"bytes":"b74e90187d503928757ecade0be487ef3d033c1de815c167f7180386e240abb7"}]}],[]]}]}]},{"prim":"Pair","args":[{"prim":"Pair","args":[{"int":"16"},{"int":"1500000"}]},{"prim":"Pair","args":[{"int":"20"},{"prim":"Pair","args":[{"prim":"False"},{"prim":"None"}]}]}]}]}}\n',
    code:
      '{parameter (or (or (or (pair %voteForProposal (nat :proposalId) (pair (key :votePk) (signature :voteSig))) (pair %getBalance (address :owner) (contract nat))) (or (pair %getTotalSupply unit (contract nat)) (bytes %fund))) (or (or (or (set %newCouncil key_hash) (pair %transfer (address :from) (pair (address :to) (nat :value)))) (or (pair %newProposal (string :description) (map :newPolicy string (pair bytes string))) (unit %freeze))) (or (pair %withdraw (address :to) (mutez :amount)) (lambda :successor %setSuccessor (or (or (pair (nat :proposalId) (pair (key :votePk) (signature :voteSig))) (pair (address :owner) (contract nat))) (or (pair unit (contract nat)) bytes)) operation))));storage (pair (pair (pair address (set key_hash)) (pair (map string (pair bytes string)) (pair (list (pair (pair string (map string (pair bytes string))) bytes)) (map key_hash nat)))) (pair (pair nat nat) (pair (big_map address nat) (pair bool (option (lambda (or (or (pair nat (pair key signature)) (pair address (contract nat))) (or (pair unit (contract nat)) bytes)) operation))))));code {CAST (pair (or (or (or (pair nat (pair key signature)) (pair address (contract nat))) (or (pair unit (contract nat)) bytes)) (or (or (or (set key_hash) (pair address (pair address nat))) (or (pair string (map string (pair bytes string))) unit)) (or (pair address mutez) (lambda (or (or (pair nat (pair key signature)) (pair address (contract nat))) (or (pair unit (contract nat)) bytes)) operation)))) (pair (pair (pair address (set key_hash)) (pair (map string (pair bytes string)) (pair (list (pair (pair string (map string (pair bytes string))) bytes)) (map key_hash nat)))) (pair (pair nat nat) (pair (big_map address nat) (pair bool (option (lambda (or (or (pair nat (pair key signature)) (pair address (contract nat))) (or (pair unit (contract nat)) bytes)) operation)))))));DUP;CAR;DIP {CDR};IF_LEFT {DIP {DUP};SWAP;CDR;CDR;CDR;CDR;IF_NONE {DIP {DUP};SWAP;CDR;CDR;CDR;CAR;IF {PUSH unit Unit;PUSH string "ContractFrozen";PAIR;FAILWITH} {};IF_LEFT {IF_LEFT {DIP {DUP;CDR;CAR;CAR;DUP;NOW;PUSH timestamp "1858-11-17T00:00:00Z";SWAP;SUB;DIP {PUSH nat 86400};EDIV;IF_NONE {PUSH string "Internal: extractDate: unexpected (1)";FAILWITH} {};CAR;PUSH nat 678575;ADD;DIP {PUSH nat 146097};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {DUP;DIP {PUSH nat 36524};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (2)";FAILWITH} {};CAR;DUP;PUSH nat 3;COMPARE;GT;IF {} {DROP;PUSH nat 3};DUP;DIP {SWAP};PUSH nat 36524;MUL;SWAP;SUB;DIP {PUSH nat 1461};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (3)";FAILWITH} {};DUP;CAR;DIP {CDR};SWAP;DUP;DIP {DIP {PUSH nat 365};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (4)";FAILWITH} {};CAR;DUP;PUSH nat 3;COMPARE;GT;IF {} {DROP;PUSH nat 3};DUP;DIP {};PUSH nat 365;MUL};SUB;PUSH nat 1;ADD;ISNAT;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (5)";FAILWITH} {}};SWAP;DIP {PUSH nat 400;MUL;PUSH nat 1;ADD;DIP {};ADD;DIP {PUSH nat 4;MUL};ADD;DIP {PUSH nat 100;MUL};ADD};SWAP;DUP;DIP {DUP;DIP {DUP};DIP {PUSH nat 400};EDIV;IF_NONE {PUSH string "Internal: isLeap: unexpected (1)";FAILWITH} {};CDR;INT;EQ;SWAP;DIP {PUSH nat 100};EDIV;IF_NONE {PUSH string "Internal: isLeap: unexpected (1)";FAILWITH} {};CDR;INT;NEQ;OR;SWAP;DIP {PUSH nat 4};EDIV;IF_NONE {PUSH string "Internal: isLeap: unexpected (1)";FAILWITH} {};CDR;INT;EQ;AND;PUSH (list nat) {31;30;31;30;31;31;30;31;30;31};SWAP;IF {PUSH nat 29} {PUSH nat 28};CONS;PUSH nat 31;CONS;DIP {PUSH nat 1;SWAP;SUB;ISNAT;IF_NONE {PUSH string "Internal: yearDayToMonthAndDay: year day <= 1";FAILWITH} {};SOME;DIP {NONE nat;PUSH nat 0}};ITER {SWAP;IF_NONE {DROP;NONE nat} {DIP 2 {PUSH nat 1;ADD};DUP;DIP {SWAP};SUB;ISNAT;IF_NONE {SWAP;DIP {DIP {DROP};PUSH nat 1;ADD;SOME};NONE nat} {DIP {DROP};SOME}}};DROP;DIP {IF_NONE {PUSH string "Internal: yearDayToMonthAndDay: year day is greater than number of days in year";FAILWITH} {}}};PUSH nat 2020;SWAP;SUB;ISNAT;IF_NONE {PUSH string "Internal: getCurrentStage: start year in future";FAILWITH} {};PUSH nat 48;MUL;DIP {PUSH int -1;ADD;ISNAT;IF_NONE {PUSH string "Internal: getCurrentStage: month = 0";FAILWITH} {};PUSH nat 4;MUL};ADD;DIP {DUP;PUSH nat 8;COMPARE;GT;IF {DROP;PUSH nat 0} {DUP;PUSH nat 15;COMPARE;GT;IF {DROP;PUSH nat 1} {PUSH nat 22;COMPARE;GT;IF {PUSH nat 2} {PUSH nat 3}}}};ADD;DUP;DIP {SWAP};COMPARE;DUP;EQ;IF {DROP;DROP;DROP} {LT;IF {DROP;PUSH string "WrongStage";PAIR;FAILWITH} {DUP;DIP {DIP {PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DIP {DROP}};PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DIP {DROP};COMPARE;EQ;IF {} {DUP;DUP;CAR;CDR;CDR;CDR;EMPTY_MAP nat nat;SWAP;ITER {DIP {DUP};CDR;DUP;DIP {SWAP};GET;IF_NONE {DIP {PUSH (option nat) (Some 1)};UPDATE} {PUSH nat 1;ADD;SOME;SWAP;UPDATE}};NONE (map string (pair bytes string));SWAP;DIG 2;DUP;CAR;CAR;CDR;SIZE;SWAP;DIP {SWAP};CAR;CDR;CDR;CAR;PUSH nat 0;SWAP;ITER {CAR;DIP {DUP;DIP {DIP {DUP;DUG 3};GET;IF_NONE {PUSH nat 0} {};PUSH nat 2;MUL;DIP {DUP};COMPARE;GT}};DIG 4;DIG 3;IF {IF_NONE {CDR;SOME} {PUSH string "Internal: \\"calcWinner: more than one winner\\"";FAILWITH}} {DIP {DROP}};DUG 3;DIP {SWAP};PUSH nat 1;ADD};DROP;DROP;DROP;IF_NONE {} {DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;PAIR};NIL (pair (pair string (map string (pair bytes string))) bytes);DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;SWAP;PAIR;PAIR;EMPTY_MAP key_hash nat;DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DROP};SWAP;PAIR;SWAP;PAIR;SWAP;PAIR;PAIR}};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;PAIR;SWAP;PAIR}}};DIP {DUP;CDR;CAR;CAR;DUP;PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DROP;PUSH nat 2;COMPARE;EQ;IF {DROP} {PUSH string "WrongStage";PAIR;FAILWITH}};DIP {DUP};DUP;CDR;CAR;DUP;HASH_KEY;DIP {DIG 2};DUP;DIP 2 {DUP;CAR;CAR;CDR};DUG 2;MEM;IF {DIP {CAR;CDR;CDR;CDR};GET;IF_NONE {} {PUSH string "VoteAlreadySubmitted";PAIR;FAILWITH}} {PUSH string "NotInCouncil";PAIR;FAILWITH};DIP {DIP {DUP};DUP;CAR;DIP {CDR;CDR;SWAP;CAR;CDR;CDR;CAR}};DUG 2;DUP;DIG 2;DIP {INT;NONE (pair (pair string (map string (pair bytes string))) bytes)};ITER {DIP {SWAP};SWAP;DUP;EQ;IF {DIP 2 {DROP};DIP {SOME}} {SWAP;DROP};PUSH int 1;SWAP;SUB;SWAP};DIP {DROP};IF_NONE {PUSH string "InvalidProposalId";PAIR;FAILWITH} {CDR;DUP;DIP {SELF;ADDRESS;DIP {DIP 4 {DUP;CDR;CAR;CAR};DIG 4};PAIR};PAIR;DIP {DROP};PACK;DIG 2;DUP;DIP {DIP {DIG 2};DUP;DIP {CHECK_SIGNATURE};SWAP;IF {DROP} {PUSH string "InvalidSignature";PAIR;FAILWITH}};HASH_KEY;DIP {SOME};DIP 2 {DUP;CAR;CDR;CDR;CDR};UPDATE;DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DROP};SWAP;PAIR;SWAP;PAIR;SWAP;PAIR;PAIR};NIL operation;PAIR} {DUP;CAR;DIP {CDR};DIP {DIP {DUP};SWAP};PAIR;DUP;CAR;DIP {CDR};DIP {CDR;CDR;CAR};GET;IF_NONE {PUSH nat 0} {};DIP {AMOUNT};TRANSFER_TOKENS;NIL operation;SWAP;CONS;PAIR}} {IF_LEFT {DUP;CAR;DIP {CDR};DIP {DIP {DUP};SWAP};PAIR;DUP;CAR;DIP {CDR};DROP;CDR;CAR;CDR;DIP {AMOUNT};TRANSFER_TOKENS;NIL operation;SWAP;CONS;PAIR} {DROP;NIL operation;PAIR}}} {SWAP;EXEC;NIL operation;SWAP;CONS;PAIR}} {IF_LEFT {DIP {DUP};SWAP;CDR;CDR;CDR;CAR;IF {PUSH unit Unit;PUSH string "ContractFrozen";PAIR;FAILWITH} {};DIP {DUP};SWAP;SWAP;DIP {CAR;CAR;CAR;SENDER;DIP {DUP};COMPARE;EQ;IF {DROP} {PUSH string "SenderCheckFailed";PAIR;FAILWITH}};IF_LEFT {IF_LEFT {DIP {DUP;CDR;CAR;CAR;DUP;NOW;PUSH timestamp "1858-11-17T00:00:00Z";SWAP;SUB;DIP {PUSH nat 86400};EDIV;IF_NONE {PUSH string "Internal: extractDate: unexpected (1)";FAILWITH} {};CAR;PUSH nat 678575;ADD;DIP {PUSH nat 146097};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {DUP;DIP {PUSH nat 36524};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (2)";FAILWITH} {};CAR;DUP;PUSH nat 3;COMPARE;GT;IF {} {DROP;PUSH nat 3};DUP;DIP {SWAP};PUSH nat 36524;MUL;SWAP;SUB;DIP {PUSH nat 1461};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (3)";FAILWITH} {};DUP;CAR;DIP {CDR};SWAP;DUP;DIP {DIP {PUSH nat 365};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (4)";FAILWITH} {};CAR;DUP;PUSH nat 3;COMPARE;GT;IF {} {DROP;PUSH nat 3};DUP;DIP {};PUSH nat 365;MUL};SUB;PUSH nat 1;ADD;ISNAT;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (5)";FAILWITH} {}};SWAP;DIP {PUSH nat 400;MUL;PUSH nat 1;ADD;DIP {};ADD;DIP {PUSH nat 4;MUL};ADD;DIP {PUSH nat 100;MUL};ADD};SWAP;DUP;DIP {DUP;DIP {DUP};DIP {PUSH nat 400};EDIV;IF_NONE {PUSH string "Internal: isLeap: unexpected (1)";FAILWITH} {};CDR;INT;EQ;SWAP;DIP {PUSH nat 100};EDIV;IF_NONE {PUSH string "Internal: isLeap: unexpected (1)";FAILWITH} {};CDR;INT;NEQ;OR;SWAP;DIP {PUSH nat 4};EDIV;IF_NONE {PUSH string "Internal: isLeap: unexpected (1)";FAILWITH} {};CDR;INT;EQ;AND;PUSH (list nat) {31;30;31;30;31;31;30;31;30;31};SWAP;IF {PUSH nat 29} {PUSH nat 28};CONS;PUSH nat 31;CONS;DIP {PUSH nat 1;SWAP;SUB;ISNAT;IF_NONE {PUSH string "Internal: yearDayToMonthAndDay: year day <= 1";FAILWITH} {};SOME;DIP {NONE nat;PUSH nat 0}};ITER {SWAP;IF_NONE {DROP;NONE nat} {DIP 2 {PUSH nat 1;ADD};DUP;DIP {SWAP};SUB;ISNAT;IF_NONE {SWAP;DIP {DIP {DROP};PUSH nat 1;ADD;SOME};NONE nat} {DIP {DROP};SOME}}};DROP;DIP {IF_NONE {PUSH string "Internal: yearDayToMonthAndDay: year day is greater than number of days in year";FAILWITH} {}}};PUSH nat 2020;SWAP;SUB;ISNAT;IF_NONE {PUSH string "Internal: getCurrentStage: start year in future";FAILWITH} {};PUSH nat 48;MUL;DIP {PUSH int -1;ADD;ISNAT;IF_NONE {PUSH string "Internal: getCurrentStage: month = 0";FAILWITH} {};PUSH nat 4;MUL};ADD;DIP {DUP;PUSH nat 8;COMPARE;GT;IF {DROP;PUSH nat 0} {DUP;PUSH nat 15;COMPARE;GT;IF {DROP;PUSH nat 1} {PUSH nat 22;COMPARE;GT;IF {PUSH nat 2} {PUSH nat 3}}}};ADD;DUP;DIP {SWAP};COMPARE;DUP;EQ;IF {DROP;DROP;DROP} {LT;IF {DROP;PUSH string "WrongStage";PAIR;FAILWITH} {DUP;DIP {DIP {PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DIP {DROP}};PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DIP {DROP};COMPARE;EQ;IF {} {DUP;DUP;CAR;CDR;CDR;CDR;EMPTY_MAP nat nat;SWAP;ITER {DIP {DUP};CDR;DUP;DIP {SWAP};GET;IF_NONE {DIP {PUSH (option nat) (Some 1)};UPDATE} {PUSH nat 1;ADD;SOME;SWAP;UPDATE}};NONE (map string (pair bytes string));SWAP;DIG 2;DUP;CAR;CAR;CDR;SIZE;SWAP;DIP {SWAP};CAR;CDR;CDR;CAR;PUSH nat 0;SWAP;ITER {CAR;DIP {DUP;DIP {DIP {DUP;DUG 3};GET;IF_NONE {PUSH nat 0} {};PUSH nat 2;MUL;DIP {DUP};COMPARE;GT}};DIG 4;DIG 3;IF {IF_NONE {CDR;SOME} {PUSH string "Internal: \\"calcWinner: more than one winner\\"";FAILWITH}} {DIP {DROP}};DUG 3;DIP {SWAP};PUSH nat 1;ADD};DROP;DROP;DROP;IF_NONE {} {DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;PAIR};NIL (pair (pair string (map string (pair bytes string))) bytes);DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;SWAP;PAIR;PAIR;EMPTY_MAP key_hash nat;DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DROP};SWAP;PAIR;SWAP;PAIR;SWAP;PAIR;PAIR}};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;PAIR;SWAP;PAIR}};DUP;DUP;CDR;CAR;CAR;DUP;PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DROP;PUSH nat 3;COMPARE;NEQ;IF {DROP} {PUSH string "WrongStage";PAIR;FAILWITH};DUP;CDR;CAR;CAR;DUP;PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DROP;PUSH nat 2;COMPARE;NEQ;IF {DROP} {PUSH string "WrongStage";PAIR;FAILWITH};DROP};DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DROP};SWAP;PAIR;PAIR;PAIR;NIL operation;PAIR} {SWAP;DIP {DUP};SWAP;DUP;CDR;CDR;SWAP;CAR;DIP 2 {DUP};DIG 2;CDR;CDR;CAR;DUP;DIP 2 {DUP};DIG 2;GET;IF_NONE {PUSH string "Address to be debited is not in ledger";FAILWITH} {};DIG 3;SWAP;SUB;DUP;ISNAT;IF_NONE {PUSH string "NotEnoughFunds";PAIR;FAILWITH} {SWAP;EQ;IF {DROP;NONE nat} {SOME}};DIG 2;UPDATE;DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;SWAP;PAIR;SWAP;DUP;CDR;CDR;SWAP;CDR;CAR;DIP 2 {DUP};DIG 2;CDR;CDR;CAR;DUP;DIP 2 {DUP};DIG 2;GET;IF_NONE {PUSH nat 0} {};DIG 3;ADD;SOME;DIG 2;UPDATE;DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;SWAP;PAIR;NIL operation;PAIR}} {IF_LEFT {DIP {DUP;CDR;CAR;CAR;DUP;NOW;PUSH timestamp "1858-11-17T00:00:00Z";SWAP;SUB;DIP {PUSH nat 86400};EDIV;IF_NONE {PUSH string "Internal: extractDate: unexpected (1)";FAILWITH} {};CAR;PUSH nat 678575;ADD;DIP {PUSH nat 146097};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {DUP;DIP {PUSH nat 36524};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (2)";FAILWITH} {};CAR;DUP;PUSH nat 3;COMPARE;GT;IF {} {DROP;PUSH nat 3};DUP;DIP {SWAP};PUSH nat 36524;MUL;SWAP;SUB;DIP {PUSH nat 1461};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (3)";FAILWITH} {};DUP;CAR;DIP {CDR};SWAP;DUP;DIP {DIP {PUSH nat 365};EDIV;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (4)";FAILWITH} {};CAR;DUP;PUSH nat 3;COMPARE;GT;IF {} {DROP;PUSH nat 3};DUP;DIP {};PUSH nat 365;MUL};SUB;PUSH nat 1;ADD;ISNAT;IF_NONE {PUSH string "Internal: toOrdinalDate: unexpected (5)";FAILWITH} {}};SWAP;DIP {PUSH nat 400;MUL;PUSH nat 1;ADD;DIP {};ADD;DIP {PUSH nat 4;MUL};ADD;DIP {PUSH nat 100;MUL};ADD};SWAP;DUP;DIP {DUP;DIP {DUP};DIP {PUSH nat 400};EDIV;IF_NONE {PUSH string "Internal: isLeap: unexpected (1)";FAILWITH} {};CDR;INT;EQ;SWAP;DIP {PUSH nat 100};EDIV;IF_NONE {PUSH string "Internal: isLeap: unexpected (1)";FAILWITH} {};CDR;INT;NEQ;OR;SWAP;DIP {PUSH nat 4};EDIV;IF_NONE {PUSH string "Internal: isLeap: unexpected (1)";FAILWITH} {};CDR;INT;EQ;AND;PUSH (list nat) {31;30;31;30;31;31;30;31;30;31};SWAP;IF {PUSH nat 29} {PUSH nat 28};CONS;PUSH nat 31;CONS;DIP {PUSH nat 1;SWAP;SUB;ISNAT;IF_NONE {PUSH string "Internal: yearDayToMonthAndDay: year day <= 1";FAILWITH} {};SOME;DIP {NONE nat;PUSH nat 0}};ITER {SWAP;IF_NONE {DROP;NONE nat} {DIP 2 {PUSH nat 1;ADD};DUP;DIP {SWAP};SUB;ISNAT;IF_NONE {SWAP;DIP {DIP {DROP};PUSH nat 1;ADD;SOME};NONE nat} {DIP {DROP};SOME}}};DROP;DIP {IF_NONE {PUSH string "Internal: yearDayToMonthAndDay: year day is greater than number of days in year";FAILWITH} {}}};PUSH nat 2020;SWAP;SUB;ISNAT;IF_NONE {PUSH string "Internal: getCurrentStage: start year in future";FAILWITH} {};PUSH nat 48;MUL;DIP {PUSH int -1;ADD;ISNAT;IF_NONE {PUSH string "Internal: getCurrentStage: month = 0";FAILWITH} {};PUSH nat 4;MUL};ADD;DIP {DUP;PUSH nat 8;COMPARE;GT;IF {DROP;PUSH nat 0} {DUP;PUSH nat 15;COMPARE;GT;IF {DROP;PUSH nat 1} {PUSH nat 22;COMPARE;GT;IF {PUSH nat 2} {PUSH nat 3}}}};ADD;DUP;DIP {SWAP};COMPARE;DUP;EQ;IF {DROP;DROP;DROP} {LT;IF {DROP;PUSH string "WrongStage";PAIR;FAILWITH} {DUP;DIP {DIP {PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DIP {DROP}};PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DIP {DROP};COMPARE;EQ;IF {} {DUP;DUP;CAR;CDR;CDR;CDR;EMPTY_MAP nat nat;SWAP;ITER {DIP {DUP};CDR;DUP;DIP {SWAP};GET;IF_NONE {DIP {PUSH (option nat) (Some 1)};UPDATE} {PUSH nat 1;ADD;SOME;SWAP;UPDATE}};NONE (map string (pair bytes string));SWAP;DIG 2;DUP;CAR;CAR;CDR;SIZE;SWAP;DIP {SWAP};CAR;CDR;CDR;CAR;PUSH nat 0;SWAP;ITER {CAR;DIP {DUP;DIP {DIP {DUP;DUG 3};GET;IF_NONE {PUSH nat 0} {};PUSH nat 2;MUL;DIP {DUP};COMPARE;GT}};DIG 4;DIG 3;IF {IF_NONE {CDR;SOME} {PUSH string "Internal: \\"calcWinner: more than one winner\\"";FAILWITH}} {DIP {DROP}};DUG 3;DIP {SWAP};PUSH nat 1;ADD};DROP;DROP;DROP;IF_NONE {} {DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;PAIR};NIL (pair (pair string (map string (pair bytes string))) bytes);DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;SWAP;PAIR;PAIR;EMPTY_MAP key_hash nat;DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DROP};SWAP;PAIR;SWAP;PAIR;SWAP;PAIR;PAIR}};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;PAIR;SWAP;PAIR}};DUP;CDR;CAR;CAR;DUP;PUSH nat 4;SWAP;EDIV;IF_NONE {PUSH string "Internal: splitCounter: unexpected (1)";FAILWITH} {};DUP;CAR;DIP {CDR};DIP {};DROP;PUSH nat 0;COMPARE;EQ;IF {DROP} {PUSH string "WrongStage";PAIR;FAILWITH}};DUP;PACK;BLAKE2B;SWAP;PAIR;DIP {DUP;CAR;CDR;CDR;CAR};CONS;DIP {DUP;DIP {CDR};CAR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;SWAP;PAIR;PAIR;NIL operation;PAIR} {DROP;PUSH bool True;DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};DIP {DROP};PAIR;SWAP;PAIR;SWAP;PAIR;SWAP;PAIR;NIL operation;PAIR}}} {DIP {DUP};SWAP;SWAP;DIP {CAR;CAR;CAR;SENDER;DIP {DUP};COMPARE;EQ;IF {DROP} {PUSH string "SenderCheckFailed";PAIR;FAILWITH}};IF_LEFT {DUP;CAR;DUP;CONTRACT unit;IF_NONE {PUSH string "InvalidReceiver";PAIR;FAILWITH} {DIP {DROP}};SWAP;CDR;UNIT;TRANSFER_TOKENS;DIP {NIL operation};CONS;PAIR} {DIP {DUP};SWAP;CDR;CDR;CDR;CAR;IF {} {PUSH unit Unit;PUSH string "ContractActive";PAIR;FAILWITH};SOME;DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CAR};CDR};DIP {DROP};SWAP;PAIR;SWAP;PAIR;SWAP;PAIR;SWAP;PAIR;NIL operation;PAIR}}}}}',
    storage:
      '(Pair (Pair (Pair 0x0158963b4895bb34f5f04323955088252919d49e1700 {0x003faad22c22aeb4d0b2c92930bc5c0d5d5cf3b685;0x00478ab1562c55ccfc169f66090d5627c8a4cc39bc;0x005f2931ed67ef176421fe74b3a58199bad671072e;0x0098c82adedb98b85ac32f8d5da333171c03bb924a;0x00c578052f1748383d913d82d84b0f0df50a56c0a0}) (Pair {Elt "url1" (Pair 0xd568d9a5924b70b34527529fd17a5d71e7d697b81777da1b2764e2a6636234cd "https://forum.stakerdao.com/uploads/short-url/bGNRrVlE3ir9sk7AB4el6Z5FmWT.pdf")} (Pair {Pair (Pair "Proposal 005 - Blend on Tezos" {Elt "url1" (Pair 0x305f752e2881c7088634478e1662ce2f1b037148d2128e71a20bcc6739385b91 "https://forum.stakerdao.com/uploads/short-url/6NXzxt6SI8wv4KCpXiIUwvLE923.pdf")}) 0xb74e90187d503928757ecade0be487ef3d033c1de815c167f7180386e240abb7} {}))) (Pair (Pair 16 1500000) (Pair 20 (Pair False None))))',
  },
  {
    json:
      '{"code":[{"prim":"parameter","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}],"annots":["%getVersion"]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address","annots":[":owner"]},{"prim":"address","annots":[":spender"]}]},{"prim":"contract","args":[{"prim":"nat"}]}],"annots":["%getAllowance"]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address","annots":[":owner"]},{"prim":"contract","args":[{"prim":"nat"}]}],"annots":["%getBalance"]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}],"annots":["%getTotalSupply"]},{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}],"annots":["%getTotalMinted"]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}],"annots":["%getTotalBurned"]},{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"address"}]}],"annots":["%getOwner"]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"address"}]}],"annots":["%getRedeemAddress"]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"list","args":[{"prim":"nat"}]},{"prim":"contract","args":[{"prim":"list","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"pair","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"nat"},{"prim":"map","args":[{"prim":"string"},{"prim":"string"}]}]}]}]}]}]}]}],"annots":["%getTokenMetadata"]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"bytes"}],"annots":["%run"]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"nat","annots":[":currentVersion"]},{"prim":"nat","annots":[":newVersion"]}]},{"prim":"pair","args":[{"prim":"lambda","args":[{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}],"annots":[":migrationScript"]},{"prim":"pair","args":[{"prim":"option","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]}],"annots":[":newCode"]},{"prim":"option","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]}],"annots":[":newPermCode"]}]}]}],"annots":["%upgrade"]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat","annots":[":current"]},{"prim":"nat","annots":[":new"]}],"annots":["%epwBeginUpgrade"]},{"prim":"lambda","args":[{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}],"annots":[":migrationscript","%epwApplyMigration"]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}],"annots":[":contractcode","%epwSetCode"]},{"prim":"unit","annots":["%epwFinishUpgrade"]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address","annots":[":from"]},{"prim":"pair","args":[{"prim":"address","annots":[":to"]},{"prim":"nat","annots":[":value"]}]}],"annots":["%transfer"]},{"prim":"pair","args":[{"prim":"address","annots":[":spender"]},{"prim":"nat","annots":[":value"]}],"annots":["%approve"]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address","annots":[":to"]},{"prim":"nat","annots":[":value"]}],"annots":["%mint"]},{"prim":"nat","annots":[":value","%burn"]}]},{"prim":"or","args":[{"prim":"address","annots":[":operator","%addOperator"]},{"prim":"address","annots":[":operator","%removeOperator"]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"address","annots":[":redeem","%setRedeemAddress"]},{"prim":"unit","annots":["%pause"]}]},{"prim":"or","args":[{"prim":"unit","annots":["%unpause"]},{"prim":"or","args":[{"prim":"address","annots":[":newOwner","%transferOwnership"]},{"prim":"unit","annots":["%acceptOwnership"]}]}]}]}]}],"annots":["%safeEntrypoints"]}]}]}]}]}]},{"prim":"storage","args":[{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]},{"prim":"pair","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]},{"prim":"pair","args":[{"prim":"nat"},{"prim":"bool"}]}]}]}]},{"prim":"code","args":[[{"prim":"CAST","args":[{"prim":"pair","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"address"}]},{"prim":"contract","args":[{"prim":"nat"}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"contract","args":[{"prim":"nat"}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}]},{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"nat"}]}]},{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"address"}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"contract","args":[{"prim":"address"}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"list","args":[{"prim":"nat"}]},{"prim":"contract","args":[{"prim":"list","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"pair","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"string"},{"prim":"pair","args":[{"prim":"nat"},{"prim":"map","args":[{"prim":"string"},{"prim":"string"}]}]}]}]}]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"nat"}]},{"prim":"pair","args":[{"prim":"lambda","args":[{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"option","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]}]},{"prim":"option","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"unit"},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]}]}]}]}]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"nat"},{"prim":"nat"}]},{"prim":"lambda","args":[{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]},{"prim":"unit"}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]}]},{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"pair","args":[{"prim":"address"},{"prim":"nat"}]},{"prim":"nat"}]},{"prim":"or","args":[{"prim":"address"},{"prim":"address"}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"address"},{"prim":"unit"}]},{"prim":"or","args":[{"prim":"unit"},{"prim":"or","args":[{"prim":"address"},{"prim":"unit"}]}]}]}]}]}]}]}]}]},{"prim":"pair","args":[{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]},{"prim":"pair","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]},{"prim":"pair","args":[{"prim":"nat"},{"prim":"bool"}]}]}]}]}]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"}]]},{"prim":"PAIR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"AMOUNT"}]]},{"prim":"TRANSFER_TOKENS"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"SWAP"},{"prim":"CONS"},{"prim":"PAIR"}]],[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"ADDRESS"}]]},{"prim":"PAIR"},{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callGetAllowance"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]]]}],[{"prim":"IF_LEFT","args":[[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"ADDRESS"}]]},{"prim":"PAIR"},{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callGetBalance"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[{"prim":"IF_LEFT","args":[[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"ADDRESS"}]]},{"prim":"PAIR"},{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callGetTotalSupply"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"ADDRESS"}]]},{"prim":"PAIR"},{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callGetTotalMinted"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]]]}]]}]]}],[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"ADDRESS"}]]},{"prim":"PAIR"},{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callGetTotalBurned"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"ADDRESS"}]]},{"prim":"PAIR"},{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callGetOwner"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]]]}],[{"prim":"IF_LEFT","args":[[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"ADDRESS"}]]},{"prim":"PAIR"},{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callGetRedeemAddress"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[{"prim":"IF_LEFT","args":[[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"ADDRESS"}]]},{"prim":"PAIR"},{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callGetTokenMetadata"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"bytes"},{"bytes":"0501000000056f776e6572"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: no field owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"UNPACK","args":[{"prim":"address"}]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: failed to unpack owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"SenderIsNotOwner"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"DROP"}],[{"prim":"PAIR"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgVersionMismatch"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"SWAP"},{"prim":"PAIR"}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"EXEC"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"IF_NONE","args":[[],[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"SWAP"},{"prim":"PAIR"}]]},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}]]]}],[{"prim":"IF_LEFT","args":[[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"bytes"},{"bytes":"0501000000056f776e6572"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: no field owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"UNPACK","args":[{"prim":"address"}]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: failed to unpack owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"SenderIsNotOwner"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]}]]},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CAR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"DIP","args":[[{"prim":"DUP"}]]},{"prim":"SWAP"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[{"prim":"DROP"},{"prim":"DROP"}],[{"prim":"PAIR"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgVersionMismatch"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}]]},{"prim":"CDR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"DUP"},{"prim":"CDR"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"},{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"True"}]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}]],[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"bytes"},{"bytes":"0501000000056f776e6572"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: no field owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"UNPACK","args":[{"prim":"address"}]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: failed to unpack owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"SenderIsNotOwner"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[],[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsNotMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"EXEC"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}]]]}]]}],[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"bytes"},{"bytes":"0501000000056f776e6572"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: no field owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"UNPACK","args":[{"prim":"address"}]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: failed to unpack owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"SenderIsNotOwner"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[],[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsNotMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}]],[{"prim":"DROP"},[{"prim":"DUP"},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"bytes"},{"bytes":"0501000000056f776e6572"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: no field owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"UNPACK","args":[{"prim":"address"}]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: failed to unpack owner"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SENDER"},{"prim":"COMPARE"},{"prim":"EQ"},{"prim":"IF","args":[[],[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"SenderIsNotOwner"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[],[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsNotMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}]]},{"prim":"DUP"},{"prim":"CDR"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"},{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"},{"prim":"PUSH","args":[{"prim":"bool"},{"prim":"False"}]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CAR"}]]},{"prim":"CDR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"}]]]}],[{"prim":"IF_LEFT","args":[[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callTransfer"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callApprove"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]]]}]]}]]}],[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callMint"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callBurn"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]]]}],[{"prim":"IF_LEFT","args":[[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callAddOperator"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callRemoveOperator"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]]]}]]}],[{"prim":"IF_LEFT","args":[[{"prim":"IF_LEFT","args":[[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callSetRedeemAddress"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callPause"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]]]}],[{"prim":"IF_LEFT","args":[[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callUnpause"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[{"prim":"IF_LEFT","args":[[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callTransferOwnership"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]],[[{"prim":"PACK"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"callAcceptOwnership"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"IF","args":[[{"prim":"UNIT"},{"prim":"PUSH","args":[{"prim":"string"},{"string":"UpgContractIsMigrating"}]},{"prim":"PAIR"},{"prim":"FAILWITH"}],[]]},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"CAR"}]]}]]},{"prim":"PAIR"},{"prim":"EXEC"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"PAIR"}]]]}]]}]]}]]}]]}]]]}]]}]]}]]}]]}],"storage":{"prim":"Pair","args":[{"int":"31"},{"prim":"Pair","args":[[{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DUP"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"CDR"}]]},{"prim":"DIP","args":[[{"prim":"DIP","args":[{"int":"2"},[{"prim":"DUP"}]]},{"prim":"DIG","args":[{"int":"2"}]}]]},{"prim":"PUSH","args":[{"prim":"string"},{"string":"code"}]},{"prim":"PAIR"},{"prim":"PACK"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"NONE","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"bytes"},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]}]}],[{"prim":"UNPACK","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"bytes"},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]}]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: failed to unpack code"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SOME"}]]},{"prim":"IF_NONE","args":[[{"prim":"DROP"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"bytes"},{"bytes":"05010000000866616c6c6261636b"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: no field fallback"}]},{"prim":"FAILWITH"}],[]]},{"prim":"UNPACK","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"string"},{"prim":"bytes"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]},{"prim":"pair","args":[{"prim":"list","args":[{"prim":"operation"}]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"bytes"}]}]}]}]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"UStore: failed to unpack fallback"}]},{"prim":"FAILWITH"}],[]]},{"prim":"SWAP"}]]},{"prim":"PAIR"},{"prim":"EXEC"}],[{"prim":"DIP","args":[[{"prim":"SWAP"},{"prim":"DROP"},{"prim":"PAIR"}]]},{"prim":"SWAP"},{"prim":"EXEC"}]]}],{"prim":"Pair","args":[{"int":"1"},{"prim":"False"}]}]}]}}\n',
    code:
      '{parameter (or (or (or (pair %getVersion unit (contract nat)) (pair %getAllowance (pair (address :owner) (address :spender)) (contract nat))) (or (pair %getBalance (address :owner) (contract nat)) (or (pair %getTotalSupply unit (contract nat)) (pair %getTotalMinted unit (contract nat))))) (or (or (pair %getTotalBurned unit (contract nat)) (pair %getOwner unit (contract address))) (or (pair %getRedeemAddress unit (contract address)) (or (pair %getTokenMetadata (list nat) (contract (list (pair nat (pair string (pair string (pair nat (map string string)))))))) (or %safeEntrypoints (or (or (or (pair %run string bytes) (pair %upgrade (pair (nat :currentVersion) (nat :newVersion)) (pair (lambda :migrationScript (big_map bytes bytes) (big_map bytes bytes)) (pair (option :newCode (lambda (pair (pair string bytes) (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes)))) (option :newPermCode (lambda (pair unit (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes)))))))) (or (pair %epwBeginUpgrade (nat :current) (nat :new)) (lambda :migrationscript %epwApplyMigration (big_map bytes bytes) (big_map bytes bytes)))) (or (or (lambda :contractcode %epwSetCode (pair (pair string bytes) (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes))) (unit %epwFinishUpgrade)) (or (pair %transfer (address :from) (pair (address :to) (nat :value))) (pair %approve (address :spender) (nat :value))))) (or (or (or (pair %mint (address :to) (nat :value)) (nat :value %burn)) (or (address :operator %addOperator) (address :operator %removeOperator))) (or (or (address :redeem %setRedeemAddress) (unit %pause)) (or (unit %unpause) (or (address :newOwner %transferOwnership) (unit %acceptOwnership))))))))));storage (pair (big_map bytes bytes) (pair (lambda (pair (pair string bytes) (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes))) (pair nat bool)));code {CAST (pair (or (or (or (pair unit (contract nat)) (pair (pair address address) (contract nat))) (or (pair address (contract nat)) (or (pair unit (contract nat)) (pair unit (contract nat))))) (or (or (pair unit (contract nat)) (pair unit (contract address))) (or (pair unit (contract address)) (or (pair (list nat) (contract (list (pair nat (pair string (pair string (pair nat (map string string)))))))) (or (or (or (or (pair string bytes) (pair (pair nat nat) (pair (lambda (big_map bytes bytes) (big_map bytes bytes)) (pair (option (lambda (pair (pair string bytes) (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes)))) (option (lambda (pair unit (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes)))))))) (or (pair nat nat) (lambda (big_map bytes bytes) (big_map bytes bytes)))) (or (or (lambda (pair (pair string bytes) (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes))) unit) (or (pair address (pair address nat)) (pair address nat)))) (or (or (or (pair address nat) nat) (or address address)) (or (or address unit) (or unit (or address unit))))))))) (pair (big_map bytes bytes) (pair (lambda (pair (pair string bytes) (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes))) (pair nat bool))));DUP;CAR;DIP {CDR};IF_LEFT {IF_LEFT {IF_LEFT {{DUP;CAR;DIP {CDR};DIP {DIP {DUP};SWAP};PAIR;CDR;CDR;CDR;CAR;DIP {AMOUNT};TRANSFER_TOKENS;NIL operation;SWAP;CONS;PAIR}} {{DUP;CAR;DIP {CDR};DIP {ADDRESS};PAIR;PACK;PUSH string "callGetAllowance";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}}} {IF_LEFT {{DUP;CAR;DIP {CDR};DIP {ADDRESS};PAIR;PACK;PUSH string "callGetBalance";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {IF_LEFT {{DUP;CAR;DIP {CDR};DIP {ADDRESS};PAIR;PACK;PUSH string "callGetTotalSupply";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {{DUP;CAR;DIP {CDR};DIP {ADDRESS};PAIR;PACK;PUSH string "callGetTotalMinted";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}}}}} {IF_LEFT {IF_LEFT {{DUP;CAR;DIP {CDR};DIP {ADDRESS};PAIR;PACK;PUSH string "callGetTotalBurned";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {{DUP;CAR;DIP {CDR};DIP {ADDRESS};PAIR;PACK;PUSH string "callGetOwner";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}}} {IF_LEFT {{DUP;CAR;DIP {CDR};DIP {ADDRESS};PAIR;PACK;PUSH string "callGetRedeemAddress";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {IF_LEFT {{DUP;CAR;DIP {CDR};DIP {ADDRESS};PAIR;PACK;PUSH string "callGetTokenMetadata";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {{IF_LEFT {IF_LEFT {IF_LEFT {IF_LEFT {{DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {{DIP {DUP;CAR;PUSH bytes 0x0501000000056f776e6572;GET;IF_NONE {PUSH string "UStore: no field owner";FAILWITH} {};UNPACK address;IF_NONE {PUSH string "UStore: failed to unpack owner";FAILWITH} {};SENDER;COMPARE;EQ;IF {} {UNIT;PUSH string "SenderIsNotOwner";PAIR;FAILWITH};DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {}};DUP;DIP {CAR;CAR;DIP {DUP;CDR;CDR;CAR};DIP {DUP};SWAP;DIP {DUP};SWAP;COMPARE;EQ;IF {DROP;DROP} {PAIR;PUSH string "UpgVersionMismatch";PAIR;FAILWITH}};DUP;DIP {CAR;CDR;DIP {DUP;CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR;SWAP;PAIR;DIP {DUP;DIP {CAR};CDR};SWAP;DROP;SWAP;PAIR};DUP;CDR;CAR;SWAP;DIP {DIP {DUP;CAR};SWAP;EXEC;DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};CDR;CDR;CAR;IF_NONE {} {DIP {DUP;CDR};DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR;DIP {DUP;DIP {CAR};CDR};SWAP;DROP;SWAP;PAIR};NIL operation;PAIR}}} {IF_LEFT {{DIP {DUP;CAR;PUSH bytes 0x0501000000056f776e6572;GET;IF_NONE {PUSH string "UStore: no field owner";FAILWITH} {};UNPACK address;IF_NONE {PUSH string "UStore: failed to unpack owner";FAILWITH} {};SENDER;COMPARE;EQ;IF {} {UNIT;PUSH string "SenderIsNotOwner";PAIR;FAILWITH};DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {}};DUP;DIP {CAR;DIP {DUP;CDR;CDR;CAR};DIP {DUP};SWAP;DIP {DUP};SWAP;COMPARE;EQ;IF {DROP;DROP} {PAIR;PUSH string "UpgVersionMismatch";PAIR;FAILWITH}};CDR;DIP {DUP;CDR};DIP {DUP;DIP {CAR};CDR};DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR;SWAP;PAIR;DIP {DUP;DIP {CAR};CDR};SWAP;DROP;SWAP;PAIR;DUP;CDR;DUP;DIP {CAR};CDR;DUP;DIP {CAR};CDR;PUSH bool True;SWAP;DROP;SWAP;PAIR;SWAP;PAIR;DIP {DUP;DIP {CAR};CDR};SWAP;DROP;SWAP;PAIR;NIL operation;PAIR}} {{DIP {DUP;CAR;PUSH bytes 0x0501000000056f776e6572;GET;IF_NONE {PUSH string "UStore: no field owner";FAILWITH} {};UNPACK address;IF_NONE {PUSH string "UStore: failed to unpack owner";FAILWITH} {};SENDER;COMPARE;EQ;IF {} {UNIT;PUSH string "SenderIsNotOwner";PAIR;FAILWITH};DUP;CDR;CDR;CDR;IF {} {UNIT;PUSH string "UpgContractIsNotMigrating";PAIR;FAILWITH}};DIP {DUP;CAR};SWAP;EXEC;DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR;NIL operation;PAIR}}}} {IF_LEFT {IF_LEFT {{DIP {DUP;CAR;PUSH bytes 0x0501000000056f776e6572;GET;IF_NONE {PUSH string "UStore: no field owner";FAILWITH} {};UNPACK address;IF_NONE {PUSH string "UStore: failed to unpack owner";FAILWITH} {};SENDER;COMPARE;EQ;IF {} {UNIT;PUSH string "SenderIsNotOwner";PAIR;FAILWITH};DUP;CDR;CDR;CDR;IF {} {UNIT;PUSH string "UpgContractIsNotMigrating";PAIR;FAILWITH}};DIP {DUP;CDR};DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR;DIP {DUP;DIP {CAR};CDR};SWAP;DROP;SWAP;PAIR;NIL operation;PAIR}} {DROP;{DUP;CAR;PUSH bytes 0x0501000000056f776e6572;GET;IF_NONE {PUSH string "UStore: no field owner";FAILWITH} {};UNPACK address;IF_NONE {PUSH string "UStore: failed to unpack owner";FAILWITH} {};SENDER;COMPARE;EQ;IF {} {UNIT;PUSH string "SenderIsNotOwner";PAIR;FAILWITH};DUP;CDR;CDR;CDR;IF {} {UNIT;PUSH string "UpgContractIsNotMigrating";PAIR;FAILWITH};DUP;CDR;DUP;DIP {CAR};CDR;DUP;DIP {CAR};CDR;PUSH bool False;SWAP;DROP;SWAP;PAIR;SWAP;PAIR;DIP {DUP;DIP {CAR};CDR};SWAP;DROP;SWAP;PAIR;NIL operation;PAIR}}} {IF_LEFT {{PACK;PUSH string "callTransfer";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {{PACK;PUSH string "callApprove";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}}}}} {IF_LEFT {IF_LEFT {IF_LEFT {{PACK;PUSH string "callMint";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {{PACK;PUSH string "callBurn";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}}} {IF_LEFT {{PACK;PUSH string "callAddOperator";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {{PACK;PUSH string "callRemoveOperator";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}}}} {IF_LEFT {IF_LEFT {{PACK;PUSH string "callSetRedeemAddress";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {{PACK;PUSH string "callPause";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}}} {IF_LEFT {{PACK;PUSH string "callUnpause";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {IF_LEFT {{PACK;PUSH string "callTransferOwnership";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}} {{PACK;PUSH string "callAcceptOwnership";PAIR;DIP {DUP;CDR;CDR;CDR;IF {UNIT;PUSH string "UpgContractIsMigrating";PAIR;FAILWITH} {};DUP;CAR;DIP {DUP;CDR;CAR}};PAIR;EXEC;DUP;CAR;DIP {CDR};DIP {DIP {DUP;DIP {CDR};CAR};SWAP;DROP;PAIR};PAIR}}}}}}}}}}}}}',
    storage:
      '(Pair 31 (Pair {DUP;CAR;DIP {CDR};DUP;DUP;CAR;DIP {CDR};DIP {DIP 2 {DUP};DIG 2};PUSH string "code";PAIR;PACK;GET;IF_NONE {NONE (lambda (pair bytes (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes)))} {UNPACK (lambda (pair bytes (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes)));IF_NONE {PUSH string "UStore: failed to unpack code";FAILWITH} {};SOME};IF_NONE {DROP;DIP {DUP;PUSH bytes 0x05010000000866616c6c6261636b;GET;IF_NONE {PUSH string "UStore: no field fallback";FAILWITH} {};UNPACK (lambda (pair (pair string bytes) (big_map bytes bytes)) (pair (list operation) (big_map bytes bytes)));IF_NONE {PUSH string "UStore: failed to unpack fallback";FAILWITH} {};SWAP};PAIR;EXEC} {DIP {SWAP;DROP;PAIR};SWAP;EXEC}} (Pair 1 False)))',
  },
];

for (const v of testData) {
  v.src = JSON.parse(v.json);
}

describe('Parser', () => {
  it('parse micheline', () => {
    const parser = new Parser();
    for (const v of testData) {
      const script = parser.parseScript(v.code);
      expect(script).toEqual(v.src?.code);

      const data = parser.parseMichelineExpression(v.storage);
      expect(data).toEqual(v.src?.storage);
    }
  });

  it('parse json', () => {
    const parser = new Parser();
    for (const v of testData) {
      const script = parser.parseJSON(v.src?.code || []);
      expect(script).toEqual(v.src?.code);

      const data = parser.parseJSON(v.src?.storage || []);
      expect(data).toEqual(v.src?.storage);
    }
  });

  it('format', () => {
    for (const v of testData) {
      let text = emitMicheline(v.src?.code || []);
      expect(text).toBe(v.code);

      text = emitMicheline(v.src?.storage || []);
      expect(text).toBe(v.storage);
    }
  });

  it('validate', () => {
    for (const v of testData) {
      assertMichelsonScript(v.src?.code || []);
      assertMichelsonData(v.src?.storage || []);
    }
  });
});
